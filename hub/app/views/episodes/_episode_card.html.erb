<%= turbo_frame_tag dom_id(episode), data: { testid: "episode-card" } do %>
  <%= render "shared/card" do %>
    <div class="mb-2 flex justify-between items-center">
      <div class="flex items-center gap-2">
        <%= status_badge(episode.status) %>
      </div>
      <div class="flex items-center gap-3">
        <% if episode.complete? %>
          <button type="button"
                  data-controller="clipboard"
                  data-clipboard-content-value="<%= episode_url(episode.prefix_id) %>"
                  data-action="click->clipboard#copy"
                  class="text-[var(--color-subtext)] hover:text-[var(--color-primary)] transition-colors cursor-pointer"
                  title="Copy share link">
            <span data-clipboard-target="copyIcon"><%= render "shared/icons/share" %></span>
            <span data-clipboard-target="checkIcon" class="hidden text-[var(--color-green)]"><%= render "shared/icons/check_circle" %></span>
          </button>
          <%= link_to episode_path(episode.prefix_id, format: :mp3), class: "text-[var(--color-subtext)] hover:text-[var(--color-primary)] transition-colors", title: "Download MP3" do %>
            <%= render "shared/icons/download" %>
          <% end %>
        <% end %>
        <% if episode.duration_seconds %>
          <span class="text-sm text-[var(--color-subtext)]"><%= format_duration(episode.duration_seconds) %></span>
        <% end %>
      </div>
    </div>
    <h2 class="text-lg font-semibold mb-1"><%= episode.title %></h2>
    <% if episode.url? && episode.source_url.present? %>
      <p class="text-xs text-[var(--color-subtext)] truncate mb-1">
        <%= link_to episode.source_url, episode.source_url, target: "_blank", class: "hover:underline" %>
      </p>
    <% end %>
    <div class="flex justify-between items-center text-sm text-[var(--color-subtext)]">
      <span>by <%= episode.author %></span>
      <span><%= episode.created_at.strftime("%b %d, %Y") %></span>
    </div>
    <p class="mt-2 text-xs text-[var(--color-subtext)] font-mono truncate">
      <%= episode.content_preview %>
    </p>
  <% end %>
<% end %>
