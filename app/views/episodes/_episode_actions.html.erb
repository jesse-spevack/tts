<%# locals: (episode:, layout: :compact) %>
<% if layout == :compact %>
  <%# Compact layout for episode cards %>
  <div class="flex items-center gap-3">
    <% if episode.complete? %>
      <%= render "shared/clipboard_button",
        content: episode_url(episode.prefix_id),
        title: "Copy share link",
        icon: "share"
      %>
      <%= link_to episode_path(episode.prefix_id, format: :mp3),
        class: "text-mist-500 dark:text-mist-400 hover:text-mist-950 dark:hover:text-white transition-colors",
        title: "Download MP3" do %>
        <%= render "shared/icons/download" %>
      <% end %>
    <% end %>
    <% if deletable?(episode) %>
      <%= button_to episode_path(episode, page: params[:page]),
        method: :delete,
        form_class: "contents",
        class: "text-mist-500 dark:text-mist-400 hover:text-red-600 dark:hover:text-red-400 transition-colors cursor-pointer",
        title: "Delete episode",
        data: { turbo_confirm: "Are you sure you want to delete '#{episode.title}'?" } do %>
        <%= render "shared/icons/trash" %>
      <% end %>
    <% end %>
    <% if episode.duration_seconds %>
      <span class="text-sm text-mist-500 dark:text-mist-400"><%= format_duration(episode.duration_seconds) %></span>
    <% end %>
  </div>
<% elsif layout == :card %>
  <%# Card layout for show page summary card â€” stacked full-width buttons %>
  <% if episode.complete? %>
    <%= link_to episode_path(episode.prefix_id, format: :mp3),
      class: "#{button_classes(type: :secondary)} flex items-center justify-center gap-2 w-full transition-colors" do %>
      <%= render "shared/icons/download", css_class: "size-5" %>
      <span>Download MP3</span>
    <% end %>

    <%= render "shared/clipboard_button",
      content: episode_url(episode.prefix_id),
      title: "Copy share link",
      icon: "share",
      button_class: "#{button_classes(type: :secondary)} flex items-center justify-center gap-2 w-full transition-colors",
      label: "Share"
    %>

    <% if episode.url? && episode.source_url.present? %>
      <%= link_to episode.source_url, target: "_blank", rel: "noopener",
        class: "#{button_classes(type: :secondary)} flex items-center justify-center gap-2 w-full transition-colors" do %>
        <%= render "shared/icons/external_link", css_class: "size-5" %>
        <span>View Original</span>
      <% end %>
    <% end %>
  <% end %>

  <% if deletable?(episode) %>
    <%= button_to episode_path(episode, page: params[:page]),
      method: :delete,
      form_class: "contents",
      class: "#{button_classes(type: :danger)} flex items-center justify-center gap-2 w-full transition-colors",
      data: { turbo_confirm: "Are you sure you want to delete '#{episode.title}'?" } do %>
      <%= render "shared/icons/trash" %>
      <span>Delete</span>
    <% end %>
  <% end %>
<% else %>
  <%# Full layout for show page with labeled buttons (legacy) %>
  <div class="flex gap-4">
    <%= render "shared/clipboard_button",
      content: episode_url(episode.prefix_id),
      title: "Copy share link",
      icon: "share",
      button_class: "flex items-center gap-2 border border-mist-200 dark:border-mist-700 text-mist-950 dark:text-white font-medium py-2 px-4 rounded-lg hover:border-mist-950 dark:hover:border-white cursor-pointer transition-colors",
      label: "Share"
    %>

    <%= link_to episode_path(episode.prefix_id, format: :mp3),
      class: "flex items-center gap-2 border border-mist-200 dark:border-mist-700 text-mist-950 dark:text-white font-medium py-2 px-4 rounded-lg hover:border-mist-950 dark:hover:border-white cursor-pointer transition-colors" do %>
      <%= render "shared/icons/download", css_class: "size-5" %>
      <span>Download MP3</span>
    <% end %>

    <% if episode.url? && episode.source_url.present? %>
      <%= link_to episode.source_url, target: "_blank", rel: "noopener",
        class: "flex items-center gap-2 border border-mist-200 dark:border-mist-700 text-mist-950 dark:text-white font-medium py-2 px-4 rounded-lg hover:border-mist-950 dark:hover:border-white cursor-pointer transition-colors" do %>
        <%= render "shared/icons/external_link", css_class: "size-5" %>
        <span>View Original</span>
      <% end %>
    <% end %>
  </div>
<% end %>
