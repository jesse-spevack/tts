{"id":"tts-0na","title":"Scope database-per-worktree isolation for parallel feature development","description":"Problem: Git worktrees share the same Rails development database, causing schema conflicts when multiple features with migrations are developed in parallel.\n\nGoal: Brainstorm and implement a solution so each worktree has its own isolated database automatically.\n\nOptions to evaluate:\n1. Directory-based DB naming in database.yml\n2. Environment variable approach\n3. Git branch-based naming\n4. Docker-based isolation\n\nConsiderations:\n- Should work automatically without manual setup per worktree\n- Should not break existing workflows\n- Should handle SQLite and potentially PostgreSQL\n- Consider test database isolation too\n- Document the chosen approach","status":"open","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T08:29:45.271096-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T08:29:45.271096-07:00"}
{"id":"tts-0qc","title":"Add comment explaining htmlToText function purpose","description":"extractor.ts:121 - Add comment explaining why custom htmlToText exists instead of using Readability's textContent.\n\nReason: Preserves paragraph breaks with double newlines for TTS - creates natural pauses between paragraphs in speech output.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:36:43.088909-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:21.135848-07:00","closed_at":"2026-01-25T12:53:21.135848-07:00","close_reason":"Closed"}
{"id":"tts-1fr","title":"Limit content script to trusted domains in manifest","description":"manifest.json:23-27 - Content script runs on all URLs which is unnecessary overhead. Limit matches to verynormal.fyi and verynormal.dev domains. Use chrome.scripting.executeScript for article extraction on other pages.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:38.309669-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T15:58:15.614097-07:00","closed_at":"2026-01-25T15:58:15.614097-07:00","close_reason":"Implemented - content script limited to trusted domains with programmatic injection for extraction"}
{"id":"tts-1gy","title":"Add error state handling","description":"Handle all error states with appropriate icon feedback:\n- Network offline: offline icon\n- Backend down (5xx): error icon\n- Rate limit hit (429): slow-down icon\n- Account suspended (401): clear token, prompt reconnect\n- Not an article: error icon\n- Extraction failed: error icon, log to backend\n\nPart of Phase 4: Extension UX","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:58.37607-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:55:08.659091-07:00","closed_at":"2026-01-24T14:55:08.659091-07:00","close_reason":"Implemented error state handling in icons.ts and background.ts - IconState types and setIconState function with badge updates","dependencies":[{"issue_id":"tts-1gy","depends_on_id":"tts-4vx","type":"blocks","created_at":"2026-01-24T13:41:10.609024-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-1kn","title":"Register Chrome Web Store developer account","description":"HUMAN TASK - Cannot be done by Claude\n\n1. Go to Chrome Web Store Developer Dashboard\n2. Pay one-time $5 registration fee\n3. Complete account verification\n\nPart of Phase 5: Polish \u0026 Deploy","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:40:15.782182-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T19:25:15.092515-07:00","closed_at":"2026-01-24T19:25:15.092515-07:00","close_reason":"Developer account registered, email verified, trader status selected"}
{"id":"tts-1ug","title":"Extract GeneratesApiToken service from connect controller","description":"extension/connect_controller.rb:12 - Move ApiToken.generate_for(Current.user) logic into GeneratesApiToken service object following app conventions.","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:00.460587-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:01.719039-07:00","closed_at":"2026-01-25T12:53:01.719039-07:00","close_reason":"Closed"}
{"id":"tts-2dw","title":"Inline revoke! logic in RevokesApiToken service","description":"1. Inline update!(revoked_at: Time.current) directly in RevokesApiToken service\n2. Remove revoke! instance method from api_token.rb\n3. Update generates_api_token.rb to not call revoke! (inline the update there too, or use the service)\n4. Update tests","status":"closed","priority":1,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T13:08:45.05399-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T13:13:01.384196-07:00","closed_at":"2026-01-25T13:13:01.384196-07:00","close_reason":"Closed"}
{"id":"tts-37o","title":"Create GetsApiToken service for active token lookup","description":"1. Create app/services/gets_api_token.rb\n2. Move active_token_for logic from ApiToken model to service\n3. Update settings/extensions_controller.rb to use GetsApiToken.call(user:)\n4. Remove active_token_for from api_token.rb\n5. Update tests","status":"closed","priority":1,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T13:08:42.592619-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T13:12:56.76651-07:00","closed_at":"2026-01-25T13:12:56.76651-07:00","close_reason":"Closed"}
{"id":"tts-3pw","title":"Add 5-second debounce logic","description":"Prevent accidental double-sends:\n- Track last successful send (URL + timestamp)\n- If same URL within 5 seconds, silently succeed (no API call)\n- Show success icon as normal\n\nPart of Phase 4: Extension UX","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:57.457534-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:55:08.579863-07:00","closed_at":"2026-01-24T14:55:08.579863-07:00","close_reason":"Implemented 5-second debounce in background.ts - lastSendTime tracking with DEBOUNCE_MS check","dependencies":[{"issue_id":"tts-3pw","depends_on_id":"tts-4vx","type":"blocks","created_at":"2026-01-24T13:41:09.20841-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-3w4","title":"Use strong parameters in SettingsController","description":"In app/controllers/settings_controller.rb:25-27, the email_episode_confirmation param is handled manually:\n\n```ruby\nif params.key?(:email_episode_confirmation)\n  update_params[:email_episode_confirmation] = params[:email_episode_confirmation] == \"1\"\nend\n```\n\nWhile functional, using Rails strong parameters would be more conventional and consistent with Rails idioms.\n\n**Recommendation:**\n```ruby\nprivate\n\ndef settings_params\n  params.permit(:voice, :email_episode_confirmation)\nend\n```\n\nThen use `settings_params` in the update action. Note: The boolean conversion from \"1\" to true would need to happen elsewhere (perhaps via an attribute normalizer on the model).","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T22:39:30.494404-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T22:42:55.530604-07:00","closed_at":"2026-01-25T22:42:55.530604-07:00","close_reason":"Implemented code review suggestions - all 5 items completed"}
{"id":"tts-4dn","title":"Add email confirmation toggle to settings page","description":"Add UI toggle for email_episode_confirmation preference to the user settings page. Currently the column exists and is checked in EpisodesMailbox, but users have no way to change it. Should allow users to opt out of receiving 'Your email is being converted to audio' confirmation emails.","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T21:47:06.557963-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T22:13:49.3945-07:00","closed_at":"2026-01-25T22:13:49.3945-07:00","close_reason":"Implemented in commit 99329a2"}
{"id":"tts-4ed","title":"Use GetsDefaultPodcastForUser instead of || in API episodes controller","description":"api/v1/episodes_controller.rb:7 - Replace defensive || pattern with GetsDefaultPodcastForUser service:\n\nCurrent: podcast = current_user.podcasts.first || CreatesDefaultPodcast.call(user: current_user)\nShould use: GetsDefaultPodcastForUser service","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:39.186542-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:47:51.493408-07:00","closed_at":"2026-01-25T12:47:51.493408-07:00","close_reason":"Implemented quick fixes"}
{"id":"tts-4jo","title":"Break background.ts into smaller modules","description":"background.ts:222 - File is too long. Split into smaller focused modules (e.g., error handling, icon management, API interactions).","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:37.06654-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T15:51:25.568729-07:00","closed_at":"2026-01-25T15:51:25.568729-07:00","close_reason":"Refactored into messages.ts, errorHandling.ts, contextMenu.ts with tests"}
{"id":"tts-4vx","title":"Wire up icon click → extract → send flow","description":"Implement main flow in background.ts:\n1. User clicks icon\n2. If not connected → open connect flow\n3. Run isArticleLike() pre-check\n4. If not article → show error icon\n5. Extract with Readability.js\n6. If extraction fails → log to backend, show error icon\n7. POST to /api/v1/episodes\n8. Show success/error icon based on response\n\nPart of Phase 4: Extension UX","status":"closed","priority":2,"issue_type":"task","assignee":"Jesse Spevack","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:56.514883-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:43:38.880596-07:00","closed_at":"2026-01-24T14:43:38.880596-07:00","close_reason":"Implemented main flow: icon click triggers extraction via content script, sends to API, shows status icons, logs failures. Dynamic popup control based on connection state.","dependencies":[{"issue_id":"tts-4vx","depends_on_id":"tts-9dw","type":"blocks","created_at":"2026-01-24T13:41:07.980834-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-4vx","depends_on_id":"tts-odj","type":"blocks","created_at":"2026-01-24T13:41:08.054931-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-4vx","depends_on_id":"tts-9a8","type":"blocks","created_at":"2026-01-24T13:41:08.128292-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-4vx","depends_on_id":"tts-ced","type":"blocks","created_at":"2026-01-24T13:41:08.198178-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-4vx","depends_on_id":"tts-ts7","type":"blocks","created_at":"2026-01-24T13:41:08.270108-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-4z1","title":"Create extension token generation endpoint","description":"Create endpoint for Connect flow:\n\nGET /api/v1/auth/extension_token\n- Requires existing session cookie (user logged in)\n- Generates new ApiToken for user\n- Returns token to extension (or redirects with token)\n\nHandle both cases:\n- User already logged in: immediate token generation\n- User not logged in: redirect to login, then back to generate token\n\nPart of Phase 1: Backend Foundation","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:10.032899-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:18:08.093843-07:00","closed_at":"2026-01-24T14:18:08.093843-07:00","close_reason":"Created POST /api/v1/extension_token endpoint with session auth, 5 passing tests","dependencies":[{"issue_id":"tts-4z1","depends_on_id":"tts-ekw","type":"blocks","created_at":"2026-01-24T13:40:42.309672-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-56s","title":"Fix duplicate ExtractedArticle type definition","description":"ExtractedArticle interface defined in both extractor.ts:8-14 and background.ts:17-23. Fix: Import from extractor.ts in background.ts instead of duplicating.","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:25.069185-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:49:06.099067-07:00","closed_at":"2026-01-25T12:49:06.099067-07:00","close_reason":"Quick fixes completed"}
{"id":"tts-5cs","title":"Remove generate_for from ApiToken, use GeneratesApiToken service","description":"1. Update extension_tokens_controller.rb to use GeneratesApiToken.call(user:) instead of ApiToken.generate_for\n2. Remove generate_for method from api_token.rb\n3. Remove TOKEN_PREFIX from api_token.rb (it's in the service now)\n4. Update any tests that call generate_for directly","status":"closed","priority":1,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T13:08:39.621479-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T13:13:25.117198-07:00","closed_at":"2026-01-25T13:13:25.117198-07:00","close_reason":"Closed"}
{"id":"tts-5q5","title":"Chrome Extension for TTS Podcast","description":"Build a Chrome extension that lets users send any webpage to their TTS podcast feed with one click, using client-side Readability.js extraction. See docs/plans/chrome-extension-plan.md for full details.","status":"closed","priority":1,"issue_type":"feature","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:38:44.986494-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:55:15.763034-07:00","closed_at":"2026-01-24T14:55:15.763034-07:00","close_reason":"Implemented Phase 1-3: Backend (ApiToken model, API controllers, rate limiting) and Extension Core (TypeScript build, Readability.js extraction, auth, popup). Remaining Phase 4-5 tasks tracked separately."}
{"id":"tts-673","title":"Add tests for ExtensionLogsController","description":"No test file exists for Api::V1::ExtensionLogsController. Create test/controllers/api/v1/extension_logs_controller_test.rb with tests for: 401 without token, 201 with valid token, log sanitization.","status":"closed","priority":1,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:21.057699-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:01.701967-07:00","closed_at":"2026-01-25T12:53:01.701967-07:00","close_reason":"Closed"}
{"id":"tts-67b","title":"Make Episode source validation methods private","description":"episode.rb:14 - Make source_url_required? and source_text_required? methods private.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:03.321711-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:47:51.477309-07:00","closed_at":"2026-01-25T12:47:51.477309-07:00","close_reason":"Implemented quick fixes"}
{"id":"tts-6j5","title":"Create /login page for extension auth flow","description":"Create a dedicated login page at /login that:\n- Reuses the 'Start listening free' modal UI (same partials)\n- Header: 'Login' (no subtitle)\n- Change 'By signing up' to 'By signing in'\n- Full page, not modal\n\n/extension/connect should redirect here if user not logged in.\n\nThis unblocks testing the extension locally.","status":"closed","priority":1,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T08:28:42.364153-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T08:31:51.664873-07:00","closed_at":"2026-01-25T08:31:51.664873-07:00","close_reason":"Created /login page with LoginsController#new, redirects from /extension/connect if not authenticated"}
{"id":"tts-6su","title":"Extract duplicate token generation logic","description":"Both EnablesEmailEpisodes and RegeneratesEmailIngestToken have identical generate_token methods:\n\n- app/services/enables_email_episodes.rb:18\n- app/services/regenerates_email_ingest_token.rb:15\n\n```ruby\ndef generate_token\n  SecureRandom.urlsafe_base64(16).downcase\nend\n```\n\n**Recommendation:** Extract to a shared concern or utility module if this pattern appears elsewhere, ensuring consistent token generation across the codebase.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T22:39:26.956941-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T22:42:55.528209-07:00","closed_at":"2026-01-25T22:42:55.528209-07:00","close_reason":"Implemented code review suggestions - all 5 items completed"}
{"id":"tts-76v","title":"Set up TypeScript build pipeline for extension","description":"Set up browser_extension/ directory with:\n- package.json with TypeScript, webpack/esbuild\n- tsconfig.json configured for Chrome extension\n- Build script to compile TS → JS\n- Watch mode for development\n\nPart of Phase 3: Extension Core","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:34.135528-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T13:51:39.470917-07:00","closed_at":"2026-01-24T13:51:39.470917-07:00","close_reason":"Implementation complete, tests passing"}
{"id":"tts-7qc","title":"Tighten ApplicationMailbox routing regex","description":"In app/mailboxes/application_mailbox.rb:2, the routing regex is:\n\n```ruby\nrouting /^readtome\\+.+@/i =\u003e :episodes\n```\n\nThis requires at least one character after `+`, but would still match `readtome+@` (plus with empty token before @) due to how the regex works with the @ anchor.\n\n**Recommendation:** Tighten to explicitly require non-@ characters:\n```ruby\nrouting /^readtome\\+[^@]+@/i =\u003e :episodes\n```\n\nThis ensures the token portion contains at least one valid character.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T22:39:28.982657-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T22:42:55.529819-07:00","closed_at":"2026-01-25T22:42:55.529819-07:00","close_reason":"Implemented code review suggestions - all 5 items completed"}
{"id":"tts-7rh","title":"Rename extension token storage key to very_normal_tts_api_token","description":"auth.ts:6 - Change TOKEN_KEY from current value to 'very_normal_tts_api_token' for clarity.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:05.638224-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:21.104198-07:00","closed_at":"2026-01-25T12:53:21.104198-07:00","close_reason":"Closed"}
{"id":"tts-82p","title":"Extract RevokesApiToken service from extensions controller","description":"settings/extensions_controller.rb:13 - Move token revocation logic into RevokesApiToken service object following app conventions.","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:01.78052-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:01.734858-07:00","closed_at":"2026-01-25T12:53:01.734858-07:00","close_reason":"Closed"}
{"id":"tts-84w","title":"Create manifest.json for Manifest V3","description":"Create manifest.json with:\n- manifest_version: 3\n- permissions: activeTab, storage\n- host_permissions for TTS domain\n- action with popup and icons\n- background service worker\n- content scripts for all URLs\n\nPart of Phase 3: Extension Core","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:35.237793-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:03:53.395982-07:00","closed_at":"2026-01-24T14:03:53.395982-07:00","close_reason":"Closed","dependencies":[{"issue_id":"tts-84w","depends_on_id":"tts-76v","type":"blocks","created_at":"2026-01-24T13:40:53.880092-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-8ix","title":"Create FindsApiToken service for token lookup","description":"1. Create app/services/finds_api_token.rb\n2. Move find_by_token logic from ApiToken model to service\n3. Update app/controllers/api/v1/base_controller.rb to use FindsApiToken.call(token:)\n4. Remove find_by_token from api_token.rb\n5. Update tests","status":"closed","priority":1,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T13:08:41.066354-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T13:14:25.628377-07:00","closed_at":"2026-01-25T13:14:25.628377-07:00","close_reason":"Closed"}
{"id":"tts-8x1","title":"Fix extension icon white background","description":"Extension icon has a white background in Chrome toolbar. Should have transparent background instead.","status":"closed","priority":2,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T08:00:24.555282-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T08:09:04.638215-07:00","closed_at":"2026-01-25T08:09:04.638215-07:00","close_reason":"Fixed extension icon white background by converting opaque white pixels (#FFFFFFFF) to transparent (#FFFFFF00) using ImageMagick. All three icon sizes (16x16, 48x48, 128x128) now have transparent backgrounds while preserving the teal icon content."}
{"id":"tts-90p","title":"Add security for email-to-podcast: opt-in + consider secret address","description":"Current implementation looks up user by sender email, which is spoofable.\n\n## Recommended approach: Secret email address + opt-in\n\n1. **Secret email address per user**\n   - Generate unique token per user (e.g., SecureRandom.urlsafe_base64(12))\n   - User's address: readtome+{token}@tts.verynormal.dev\n   - Store token in users table (email_ingest_token column)\n   - Lookup user by token in +address, NOT by sender email\n\n2. **Opt-in requirement**\n   - Add email_episodes_enabled column (default false)\n   - User enables in settings, which reveals their unique address\n   - Disabling regenerates the token (invalidates old address)\n\n## Implementation notes\n- Update ApplicationMailbox routing to capture +token\n- Update EpisodesMailbox to lookup by token instead of sender\n- Add settings UI to enable/disable and show unique address\n- Consider \"regenerate address\" button for users who want a new token\n\n## Why this approach\n- Unguessable: attacker can't know user's unique address\n- Opt-in: user must explicitly enable\n- Zero friction: once enabled, just email the address\n- Revocable: disable feature or regenerate token if compromised","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T21:25:04.323996-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T22:13:49.390896-07:00","closed_at":"2026-01-25T22:13:49.390896-07:00","close_reason":"Implemented in commit 99329a2"}
{"id":"tts-957","title":"Add composite index on api_tokens user_id + revoked_at","description":"active_token_for(user) queries by user and revoked_at: nil. Add composite index [:user_id, :revoked_at] to optimize this common access pattern.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:40.353571-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:51:26.439512-07:00","closed_at":"2026-01-25T12:51:26.439512-07:00","close_reason":"Added composite index on user_id and revoked_at"}
{"id":"tts-9a8","title":"Implement Readability wrapper and pre-check (extractor.ts)","description":"Create extractor.ts module:\n- Bundle Mozilla Readability.js\n- isArticleLike() pre-check function\n- extract() function returning { title, content, author, description, url }\n- Handle extraction failures\n\nPre-check heuristics:\n- Has \u003carticle\u003e element\n- Has main content area\n- Has 200+ words\n- Has article meta tags\n\nPart of Phase 3: Extension Core","status":"closed","priority":2,"issue_type":"task","assignee":"Jesse Spevack","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:38.941883-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:38:44.388983-07:00","closed_at":"2026-01-24T14:38:44.388983-07:00","close_reason":"Implemented extractor.ts with isArticleLike() and extract() using Mozilla Readability","dependencies":[{"issue_id":"tts-9a8","depends_on_id":"tts-76v","type":"blocks","created_at":"2026-01-24T13:40:57.660248-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-9dw","title":"Implement token storage (auth.ts)","description":"Create auth.ts module:\n- Store token in chrome.storage.sync\n- Retrieve token\n- Clear token (for disconnect)\n- Check if connected (token exists)\n\nPart of Phase 3: Extension Core","status":"closed","priority":2,"issue_type":"task","assignee":"Jesse Spevack","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:36.39781-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:34:37.689916-07:00","closed_at":"2026-01-24T14:34:37.689916-07:00","close_reason":"auth.ts module implemented with storeToken, getToken, clearToken, isConnected functions. All 9 tests passing.","dependencies":[{"issue_id":"tts-9dw","depends_on_id":"tts-76v","type":"blocks","created_at":"2026-01-24T13:40:55.349473-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-9hk","title":"Change console.log to console.error in background.ts:129","description":"background.ts:129 - Use console.error instead of console.log for error logging.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:35.551309-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:21.120434-07:00","closed_at":"2026-01-25T12:53:21.120434-07:00","close_reason":"Closed"}
{"id":"tts-9q1","title":"Add verynormal.dev to manifest host_permissions","description":"manifest.json:10-12 - Missing host permission for production domain. API calls to tts.verynormal.dev will fail. Add https://*.verynormal.dev/* to host_permissions array.","status":"closed","priority":0,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:08.879743-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:47:51.374805-07:00","closed_at":"2026-01-25T12:47:51.374805-07:00","close_reason":"Implemented quick fixes"}
{"id":"tts-ced","title":"Implement icon state management (icons.ts)","description":"Create icons.ts module:\n- Set icon to different states: neutral, loading, success, error, offline\n- Success/error states auto-revert to neutral after 2-3 seconds\n- Different icon images or badge text for each state\n\nPart of Phase 4: Extension UX","status":"closed","priority":2,"issue_type":"task","assignee":"Jesse Spevack","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:53.837738-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:39:56.389522-07:00","closed_at":"2026-01-24T14:39:56.389522-07:00","close_reason":"Implemented icons.ts with setIconState for neutral/loading/success/error/offline states, auto-revert for success/error, full test coverage","dependencies":[{"issue_id":"tts-ced","depends_on_id":"tts-76v","type":"blocks","created_at":"2026-01-24T13:41:03.74246-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-dau","title":"Implement auth callback to pass token to extension","description":"After user authenticates, the token needs to be passed back to the extension.\n\nCurrent state: /api/v1/extension_token returns JSON but extension has no way to receive it.\n\nOptions:\n1. Redirect to chrome-extension://\u003cid\u003e/callback?token=... \n2. Use a web page that calls chrome.runtime.sendMessage\n3. Use a dedicated callback page that stores token via postMessage\n\nNeed to implement the callback mechanism so extension can store the token after auth.","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T08:04:21.217705-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T08:10:12.976471-07:00","closed_at":"2026-01-25T08:10:12.976471-07:00","close_reason":"Implemented GET /extension/connect endpoint for auth callback. The page requires login, generates an API token, and passes it to the extension via data attributes and custom events. Updated content.ts to listen for tokens on the connect page, and updated popup.ts and background.ts to use the new URL."}
{"id":"tts-dpv","title":"Add email_ingest_address convenience method to User model","description":"The pattern `GeneratesEmailIngestAddress.call(user: Current.user)` is used in multiple places (settings controller, views). A convenience method on User would be cleaner and more idiomatic.\n\n**Recommendation:** Add to app/models/user.rb:\n```ruby\ndef email_ingest_address\n  GeneratesEmailIngestAddress.call(user: self)\nend\n```\n\nThis allows simpler usage: `Current.user.email_ingest_address` instead of the service call.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T22:39:28.016061-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T22:42:55.528969-07:00","closed_at":"2026-01-25T22:42:55.528969-07:00","close_reason":"Implemented code review suggestions - all 5 items completed"}
{"id":"tts-dxu","title":"Handle JSON parse errors in api.ts error handling","description":"api.ts:60 - response.json() throws on non-JSON error pages (e.g., HTML error page). Wrap in try/catch and use default error message on parse failure.","status":"closed","priority":2,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:24.159297-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:21.064652-07:00","closed_at":"2026-01-25T12:53:21.064652-07:00","close_reason":"Closed"}
{"id":"tts-e77","title":"Investigate removing sign_in route redirect","description":"routes.rb:18 - Comment asks if we can delete the sign_in redirect. Investigate if this route is still needed for backwards compatibility or can be removed.","status":"closed","priority":4,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:47.87414-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T15:50:57.553085-07:00","closed_at":"2026-01-25T15:50:57.553085-07:00","close_reason":"Keep redirects - 2 lines, harmless backwards compatibility"}
{"id":"tts-ekw","title":"Create Api::V1::BaseController with token auth","description":"Create base controller for API v1 namespace with:\n- Bearer token authentication (Authorization header)\n- Token lookup and validation\n- Set current_user from token\n- Handle 401 for invalid/missing/revoked tokens\n- Update last_used_at on successful auth\n\nPart of Phase 1: Backend Foundation","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:07.168089-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:14:27.71814-07:00","closed_at":"2026-01-24T14:14:27.71814-07:00","close_reason":"Created Api::V1::BaseController with Bearer token auth, last_used_at tracking, and 7 passing tests","dependencies":[{"issue_id":"tts-ekw","depends_on_id":"tts-r8l","type":"blocks","created_at":"2026-01-24T13:40:39.833879-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-ekw","depends_on_id":"tts-hyq","type":"blocks","created_at":"2026-01-24T13:40:39.906605-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-er4","title":"Email-to-Podcast: Allow episode creation via email","description":"Allow users to create podcast episodes by emailing content to readtome@tts.verynormal.dev. Email body becomes episode content, processed through existing LLM pipeline. Sender email maps to user account.","status":"closed","priority":1,"issue_type":"feature","owner":"jspevack@gmail.com","created_at":"2026-01-24T14:41:28.817238-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:52:23.508108-07:00","closed_at":"2026-01-24T14:52:23.508108-07:00","close_reason":"Email-to-podcast feature committed in ab8b0a7"}
{"id":"tts-f3y","title":"Use Stimulus for JavaScript in extension connect view","description":"extension/connect/show.html.erb:47 - Replace inline JavaScript with Stimulus controller following app conventions.","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:04.678968-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:51:04.850846-07:00","closed_at":"2026-01-25T12:51:04.850846-07:00","close_reason":"Closed"}
{"id":"tts-fj5","title":"Validate domain origin before accepting tokens in content.ts","description":"content.ts:21-33 - Token injection vulnerability. Any page can dispatch tts-extension-token event or set data-tts-token attribute. Fix: Check window.location.hostname against trusted domains list before accepting tokens.","status":"closed","priority":0,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:07.752963-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:50:44.319445-07:00","closed_at":"2026-01-25T12:50:44.319445-07:00","close_reason":"Closed"}
{"id":"tts-fkm","title":"Redesign ApiToken to use pk_live_/pk_test_ prefix pattern","description":"Refactor ApiToken model:\n- Change prefix from tts_ext_ to pk_live_ (production) or pk_test_ (dev/test)\n- Remove token_prefix database column (migration needed)\n- Token shown once at generation, never stored/displayed again\n- Update Settings/Extensions page to show status + metadata (created_at, last_used_at) instead of token value\n\nFollows Stripe API key pattern.","status":"closed","priority":1,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:36:40.238092-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:44:23.725703-07:00","closed_at":"2026-01-25T12:44:23.725703-07:00","close_reason":"Implemented pk_live_/pk_test_ prefix pattern, removed token_prefix column references, updated all tests"}
{"id":"tts-g8n","title":"Add documentation explaining content.ts purpose","description":"content.ts:102 - Add comments/documentation explaining what the content script does: token capture from connect page, article extraction on demand via message passing.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:38.108789-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:21.151291-07:00","closed_at":"2026-01-25T12:53:21.151291-07:00","close_reason":"Closed"}
{"id":"tts-hyq","title":"Add token generation and revocation logic","description":"Add methods to ApiToken model for:\n- Generating new tokens (returns plain token once, stores hashed)\n- Revoking tokens (sets revoked_at)\n- Validating tokens (lookup by hash, check not revoked)\n- Finding by prefix (for display in UI)\n\nOne active token per user - generating new token revokes old one.\n\nPart of Phase 1: Backend Foundation","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:05.606183-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:03:53.393909-07:00","closed_at":"2026-01-24T14:03:53.393909-07:00","close_reason":"Closed","dependencies":[{"issue_id":"tts-hyq","depends_on_id":"tts-r8l","type":"blocks","created_at":"2026-01-24T13:40:37.679151-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-hzm","title":"Create Api::V1::EpisodesController","description":"Create endpoint for extension to submit articles:\n\nPOST /api/v1/episodes\n- Accepts: title, content, url, author, description\n- Creates episode for user's primary podcast\n- Uses account default voice/settings\n- Returns { id: 'episode_xxx' } on success\n\nError responses:\n- 401 Unauthorized (bad token)\n- 422 Unprocessable Entity (validation errors)\n- 429 Too Many Requests (rate limited)\n\nPart of Phase 1: Backend Foundation","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:08.381373-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:26:42.797196-07:00","closed_at":"2026-01-24T14:26:42.797196-07:00","close_reason":"Implemented Api::V1::EpisodesController with CreatesExtensionEpisode service","dependencies":[{"issue_id":"tts-hzm","depends_on_id":"tts-ekw","type":"blocks","created_at":"2026-01-24T13:40:40.755206-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-iw4","title":"Fix token hashing to use HMAC with secret","description":"api_token.rb uses plain SHA256 without secret, vulnerable to rainbow table attacks if DB compromised. Fix: Use OpenSSL::HMAC.hexdigest with Rails secret_key_base","status":"closed","priority":0,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:05.843285-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:47:51.409346-07:00","closed_at":"2026-01-25T12:47:51.409346-07:00","close_reason":"Implemented quick fixes"}
{"id":"tts-jzm","title":"Update privacy policy for extension","description":"Update /privacy to cover:\n- Extension collects current page URL and content\n- Content sent to TTS servers for processing\n- No data sold to third parties\n\nPart of Phase 2: Web App UI","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:21.509304-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:50:23.172665-07:00","closed_at":"2026-01-24T14:50:23.172665-07:00","close_reason":"Added Browser Extension section covering page content collection, auth token storage, and error logging"}
{"id":"tts-k11","title":"Simplify extension click: auth or extract based on token state","description":"Change icon click behavior:\n- If no API token stored: open auth page directly\n- If token exists: extract article and send to API\n\nRemove popup intermediary for connect flow. Disconnect already handled via Settings → Extensions page in web app.","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T08:03:31.219793-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T08:12:02.034634-07:00","closed_at":"2026-01-25T08:12:02.034634-07:00","close_reason":"Simplified extension click behavior: removed default_popup from manifest.json so chrome.action.onClicked always fires. When clicked, if no token exists, opens /extension/connect directly; if token exists, triggers article extraction. Removed updatePopupState() and related listeners from background.ts. Also fixed production URLs in api.ts and popup.ts (were still using localhost).","dependencies":[{"issue_id":"tts-k11","depends_on_id":"tts-dau","type":"blocks","created_at":"2026-01-25T08:04:27.281339-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-kwg","title":"Remove unused popup.html and popup.js from extension build","status":"closed","priority":4,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T16:26:35.482531-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T20:28:24.251276-07:00","closed_at":"2026-01-25T20:28:24.251276-07:00","close_reason":"Removed unused popup files"}
{"id":"tts-lhy","title":"Add fetch timeout with AbortController in api.ts","description":"api.ts:46-53 - No timeout on fetch calls. Slow/hanging requests block indefinitely. Fix: Add AbortController with 30 second timeout.","status":"closed","priority":2,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:23.387884-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:21.081669-07:00","closed_at":"2026-01-25T12:53:21.081669-07:00","close_reason":"Closed"}
{"id":"tts-lj2","title":"Replace popup with context menu for disconnect","description":"Remove popup.ts and popup.html - not needed since icon click must remain one-click article send.\n\nAdd right-click context menu on extension icon with 'Disconnect from TTS' option using chrome.contextMenus API:\n- Register menu in chrome.runtime.onInstalled\n- Handle click to clear token and show disconnected badge state\n- Add 'contextMenus' permission to manifest","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:36:44.960478-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:21.048106-07:00","closed_at":"2026-01-25T12:53:21.048106-07:00","close_reason":"Closed"}
{"id":"tts-lum","title":"Change ExtensionLogsController log level to error","description":"extension_logs_controller.rb:6 - Change Rails.logger.info to Rails.logger.error since these are error logs from the extension.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:37:41.255803-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:47:51.442567-07:00","closed_at":"2026-01-25T12:47:51.442567-07:00","close_reason":"Implemented quick fixes"}
{"id":"tts-m9v","title":"Change HTTP 429 to 403 for episode limit exceeded","description":"episodes_controller.rb:37 - Using 429 Too Many Requests for business logic (tier limits). 429 is for rate limiting. Use 403 Forbidden or 402 Payment Required for tier limits.","status":"closed","priority":3,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:37.490881-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:47:51.460797-07:00","closed_at":"2026-01-25T12:47:51.460797-07:00","close_reason":"Implemented quick fixes"}
{"id":"tts-mh5","title":"Remove unused @anthropic-ai/sdk from extension package.json","description":"package.json:17 lists @anthropic-ai/sdk as dependency but it appears unused in extension code. Remove to reduce bundle size.","status":"closed","priority":4,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:41.305678-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:49:06.082433-07:00","closed_at":"2026-01-25T12:49:06.082433-07:00","close_reason":"Quick fixes completed"}
{"id":"tts-n9g","title":"Submit extension to Chrome Web Store","description":"HUMAN TASK - Cannot be done by Claude\n\n1. Upload zip package to Developer Dashboard\n2. Fill in listing details (descriptions, screenshots)\n3. Link privacy policy URL\n4. Set visibility to Unlisted\n5. Submit for review\n\nReview typically takes 1-3 business days.\n\nPart of Phase 5: Polish \u0026 Deploy","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:40:16.588047-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T20:52:51.587753-07:00","closed_at":"2026-01-25T20:52:51.587753-07:00","close_reason":"Submitted to Chrome Web Store for review","dependencies":[{"issue_id":"tts-n9g","depends_on_id":"tts-rs7","type":"blocks","created_at":"2026-01-24T13:41:17.470884-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-n9g","depends_on_id":"tts-1kn","type":"blocks","created_at":"2026-01-24T13:41:17.539865-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-n9g","depends_on_id":"tts-veg","type":"blocks","created_at":"2026-01-24T13:41:17.609829-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-nnm","title":"Add nil check for Current.user in ExtensionTokensController","description":"extension_tokens_controller.rb:6 - If authentication fails silently, Current.user could be nil causing errors. Add explicit nil check with 401 response.","status":"closed","priority":0,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:06.755066-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:47:51.393008-07:00","closed_at":"2026-01-25T12:47:51.393008-07:00","close_reason":"Implemented quick fixes"}
{"id":"tts-odj","title":"Implement API client (api.ts)","description":"Create api.ts module:\n- POST /api/v1/episodes with bearer token\n- POST /api/v1/extension_logs for failures\n- Handle response codes (401, 422, 429)\n- Return typed responses\n\nPart of Phase 3: Extension Core","status":"closed","priority":2,"issue_type":"task","assignee":"Jesse Spevack","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:37.447855-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:37:21.55207-07:00","closed_at":"2026-01-24T14:37:21.55207-07:00","close_reason":"API client with createEpisode and logExtensionFailure, includes Retry-After handling for rate limits","dependencies":[{"issue_id":"tts-odj","depends_on_id":"tts-76v","type":"blocks","created_at":"2026-01-24T13:40:56.622732-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-odj","depends_on_id":"tts-hzm","type":"blocks","created_at":"2026-01-24T13:40:56.691982-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-p3x","title":"Add token format validation in auth.ts storeToken","description":"auth.ts:11 - No validation of token format before storing. Add regex validation for tts_ext_ prefix and expected length before storing to chrome.storage.sync.","status":"closed","priority":1,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:09.565124-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:50:44.336321-07:00","closed_at":"2026-01-25T12:50:44.336321-07:00","close_reason":"Closed"}
{"id":"tts-r8l","title":"Create ApiToken model and migration","description":"Create the ApiToken model for storing extension authentication tokens.\n\nSchema:\n- user_id (references users, not null)\n- token_digest (string, not null, hashed)\n- token_prefix (string, not null, first 8 chars for display)\n- last_used_at (datetime)\n- revoked_at (datetime)\n- timestamps\n\nIndexes:\n- unique index on token_digest\n- index on token_prefix\n\nPart of Phase 1: Backend Foundation","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:04.484217-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T13:51:39.468469-07:00","closed_at":"2026-01-24T13:51:39.468469-07:00","close_reason":"Implementation complete, tests passing"}
{"id":"tts-rfc","title":"Scope Chrome extension implementation from PR #172 proposal","description":"Based on the Chrome extension proposal in PR #172, break down the implementation into discrete tasks.\n\n## Background\nPR #172 proposes a minimal Chrome extension (~100 LOC) using:\n- TypeScript with Manifest V3\n- Server-side extraction (reuse existing ExtractsArticle service)\n- Monorepo structure (browser_extension/ directory)\n- Bearer token authentication\n- Context menu + icon-click triggers\n- Toast notifications for feedback\n\n## Scoping Areas to Define\n\n### Backend Changes\n- API tokens table for authentication\n- New API endpoint for extension submissions\n- CORS configuration\n- Rate limiting\n\n### Extension Implementation\n- Manifest V3 setup\n- TypeScript build pipeline\n- Authentication flow (token storage)\n- UI components (popup, context menu, toasts)\n\n### Testing Strategy\n- Jest unit tests for extension\n- Rails integration tests for API endpoint\n- Manual testing checklist\n\n### Deployment\n- Chrome Web Store submission process\n- Firefox Add-ons path\n- GitHub Actions automation\n\n## Deliverable\nA set of beads tasks with dependencies that can be executed to build the Chrome extension feature.","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T10:20:58.211349-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T13:41:26.793-07:00","closed_at":"2026-01-24T13:41:26.793-07:00","close_reason":"Scoping complete - created 25 tasks with dependencies across 5 phases"}
{"id":"tts-rs7","title":"Package extension for Chrome Web Store","description":"Create distribution package:\n- Build production bundle\n- Create zip file with all assets\n- Verify manifest is complete\n- Test zip installs correctly in developer mode\n\nPart of Phase 5: Polish \u0026 Deploy","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:40:14.731506-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T19:26:51.720946-07:00","closed_at":"2026-01-24T19:26:51.720946-07:00","close_reason":"Built production bundle, created tts-extension-v0.1.0.zip (33KB)","dependencies":[{"issue_id":"tts-rs7","depends_on_id":"tts-4vx","type":"blocks","created_at":"2026-01-24T13:41:16.13382-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-rs7","depends_on_id":"tts-3pw","type":"blocks","created_at":"2026-01-24T13:41:16.202579-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-rs7","depends_on_id":"tts-1gy","type":"blocks","created_at":"2026-01-24T13:41:16.273414-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-rs7","depends_on_id":"tts-tlw","type":"blocks","created_at":"2026-01-24T13:41:16.340936-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-s6l","title":"Create Settings → Extensions page","description":"New page at /settings/extensions showing:\n- Connection status (connected/not connected)\n- Token prefix display ('tts_ext_abc1...')\n- Last used timestamp\n- Link to Chrome Web Store (unlisted URL)\n\nPart of Phase 2: Web App UI","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:19.747693-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:30:09.091625-07:00","closed_at":"2026-01-24T14:30:09.091625-07:00","close_reason":"Implemented Settings::ExtensionsController at /settings/extensions with connection status, token info, and last used timestamp display","dependencies":[{"issue_id":"tts-s6l","depends_on_id":"tts-r8l","type":"blocks","created_at":"2026-01-24T13:40:47.009974-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-sqz","title":"Sanitize error messages in email notifications","description":"Map technical error messages to user-friendly versions in EmailEpisodeMailer templates. Currently @error is displayed raw, which may show technical jargon like 'LLM processing failed' that could confuse users.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T21:43:36.545033-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T22:13:49.393196-07:00","closed_at":"2026-01-25T22:13:49.393196-07:00","close_reason":"Implemented in commit 99329a2"}
{"id":"tts-t3z","title":"Add rate limiting to API","description":"Add rate limiting for extension API:\n- Limit: 20 episodes per hour per user\n- Use Rack::Attack or custom middleware\n- Return 429 with Retry-After header when exceeded\n\nPart of Phase 1: Backend Foundation","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:09.230346-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:31:38.745713-07:00","closed_at":"2026-01-24T14:31:38.745713-07:00","close_reason":"Rate limiting implemented with Rack::Attack (20/hour limit)","dependencies":[{"issue_id":"tts-t3z","depends_on_id":"tts-hzm","type":"blocks","created_at":"2026-01-24T13:40:41.531092-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-t9w","title":"Add tests for extension content.ts, popup.ts, background.ts","description":"Add tests for content.ts. Note: popup.ts doesn't exist (extension uses one-click model), background.ts already has tests from refactoring (messages.test.ts, errorHandling.test.ts, contextMenu.test.ts).\n\nTest cases for content.ts:\n1. isTrustedDomain - accepts verynormal.fyi, verynormal.dev, localhost and subdomains\n2. isTrustedDomain - rejects untrusted domains\n3. checkForExtensionToken - only runs on /extension/connect paths\n4. checkForExtensionToken - skips untrusted domains\n5. handleTokenReceived - stores token and notifies background\n6. Message handler - responds to EXTRACT_ARTICLE\n7. handleExtractArticle - returns NOT_ARTICLE for non-article pages\n8. handleExtractArticle - returns extracted article on success","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:39.206535-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T15:56:11.641955-07:00","closed_at":"2026-01-25T15:56:11.641955-07:00","close_reason":"Added content.ts tests, popup.ts doesn't exist, background.ts covered by refactor"}
{"id":"tts-tlw","title":"Create extension icons from TTS branding","description":"Create icon assets for extension:\n- icon-16.png (16x16)\n- icon-48.png (48x48)  \n- icon-128.png (128x128)\n- icon-success.png (with checkmark overlay)\n- icon-error.png (with X overlay)\n- icon-loading.png (or use badge)\n\nUse existing TTS branding/logo.\n\nPart of Phase 5: Polish \u0026 Deploy","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:40:13.171955-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:47:45.823162-07:00","closed_at":"2026-01-24T14:47:45.823162-07:00","close_reason":"Icons created from app favicon (16, 48, 128px)"}
{"id":"tts-ts7","title":"Implement popup with connect button","description":"Create popup.html and popup.ts:\n- When not connected: show 'Connect to TTS' button\n- Button opens TTS auth page for token generation\n- When connected: show 'Disconnect' option\n- Minimal UI, clean design\n\nPart of Phase 4: Extension UX","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:55.038113-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:41:16.651339-07:00","closed_at":"2026-01-24T14:41:16.651339-07:00","close_reason":"Implemented popup.ts with connect/disconnect UI and auth flow","dependencies":[{"issue_id":"tts-ts7","depends_on_id":"tts-9dw","type":"blocks","created_at":"2026-01-24T13:41:05.81587-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-ts7","depends_on_id":"tts-ced","type":"blocks","created_at":"2026-01-24T13:41:05.885027-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-ttw","title":"Add extension link to Settings page","description":"Update Settings → Extensions page:\n- Add link to Chrome Web Store listing (unlisted URL)\n- 'Install Browser Extension' call-to-action\n- Brief description of what extension does\n\nPart of Phase 5: Polish \u0026 Deploy","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:40:17.390687-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:50:34.375124-07:00","closed_at":"2026-01-25T12:50:34.375124-07:00","close_reason":"Extension link already exists in Settings page (lines 60-64)","dependencies":[{"issue_id":"tts-ttw","depends_on_id":"tts-xzc","type":"blocks","created_at":"2026-01-24T13:41:19.892611-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-ttw","depends_on_id":"tts-n9g","type":"blocks","created_at":"2026-01-24T13:41:19.961845-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-v4i","title":"Sanitize user input in ExtensionLogsController logging","description":"extension_logs_controller.rb:6 - Log injection vulnerability. User-controlled error_type and url params logged without sanitization. Fix: Strip newlines and limit length before logging.","status":"closed","priority":2,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:40:22.001858-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:47:51.426046-07:00","closed_at":"2026-01-25T12:47:51.426046-07:00","close_reason":"Implemented quick fixes"}
{"id":"tts-veg","title":"Write Chrome Web Store descriptions","description":"Write listing content:\n- Short description (132 chars max)\n- Detailed description (features, how it works)\n- Screenshot(s) showing extension in action\n\nPart of Phase 5: Polish \u0026 Deploy","status":"closed","priority":3,"issue_type":"task","assignee":"Jesse Spevack","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:40:13.959082-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:50:44.015369-07:00","closed_at":"2026-01-24T14:50:44.015369-07:00","close_reason":"Created STORE_LISTING.md with short description (91 chars) and detailed description covering features, how it works, requirements, and privacy."}
{"id":"tts-wuq","title":"Extension badge colors should respect system light/dark mode","description":"Extension badge colors (success green, error red, etc.) should detect OS prefers-color-scheme and use appropriate Catppuccin colors:\n- Light mode: #40a02b (green), #d20f39 (red)\n- Dark mode: #a6e3a1 (green), #f38ba8 (red)\n\nUse matchMedia('(prefers-color-scheme: dark)') to detect and update colors accordingly.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T08:53:34.683586-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T09:29:20.095415-07:00","closed_at":"2026-01-25T09:29:20.095415-07:00","close_reason":"Implemented system light/dark mode detection using matchMedia, badge colors now use Catppuccin Latte (light) or Mocha (dark) colors"}
{"id":"tts-xoa","title":"Extract hardcoded email domain to configuration","description":"In app/services/generates_email_ingest_address.rb:14, the email domain is hardcoded:\n\n```ruby\n\"readtome+#{@user.email_ingest_token}@tts.verynormal.dev\"\n```\n\nThis makes it harder to use different domains per environment (development, staging, production).\n\n**Recommendation:** Extract to Rails configuration:\n```ruby\n\"readtome+#{@user.email_ingest_token}@#{Rails.configuration.x.email_ingest_domain}\"\n```\n\nThen set in config/environments/*.rb or via environment variable.","status":"closed","priority":3,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T22:39:25.465899-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T22:42:55.527306-07:00","closed_at":"2026-01-25T22:42:55.527306-07:00","close_reason":"Implemented code review suggestions - all 5 items completed"}
{"id":"tts-xzc","title":"Add connect/disconnect UI to Extensions page","description":"Add to Extensions page:\n- 'Disconnect' button to revoke token\n- Confirmation dialog before disconnect\n- Success/error feedback after disconnect\n- Handle case where no token exists\n\nPart of Phase 2: Web App UI","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-24T13:39:20.714054-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-24T14:34:18.508391-07:00","closed_at":"2026-01-24T14:34:18.508391-07:00","close_reason":"Disconnect button with confirmation dialog implemented, success/error feedback via flash messages","dependencies":[{"issue_id":"tts-xzc","depends_on_id":"tts-s6l","type":"blocks","created_at":"2026-01-24T13:40:48.348469-07:00","created_by":"Jesse Spevack"},{"issue_id":"tts-xzc","depends_on_id":"tts-4z1","type":"blocks","created_at":"2026-01-24T13:40:48.418201-07:00","created_by":"Jesse Spevack"}]}
{"id":"tts-y99","title":"Audit PR view changes against existing views for consistency","description":"Review each view file changed in PR #176 against existing views to ensure consistency in:\n- HTML structure and indentation\n- Tailwind CSS class patterns and conventions\n- UI component usage (buttons, forms, cards, etc.)\n- Color schemes and theming\n- Accessibility attributes (aria labels, etc.)\n- Responsive design patterns\n\nViews to audit:\n- app/views/extension/connect/show.html.erb\n- app/views/logins/new.html.erb\n- app/views/settings/extensions/show.html.erb\n- app/views/settings/show.html.erb (changes)\n- app/views/pages/privacy.html.erb (changes)\n- app/views/billing_mailer/upgrade_nudge.html.erb (changes)\n- app/views/billing_mailer/welcome.html.erb (changes)\n\nCompare against existing patterns in app/views/ to identify inconsistencies.","status":"closed","priority":2,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T11:58:31.464685-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:51:28.135466-07:00","closed_at":"2026-01-25T12:51:28.135466-07:00","close_reason":"Closed"}
{"id":"tts-yk8","title":"Simplify token prefix to pk_live_ only","description":"1. Change TOKEN_PREFIX in generates_api_token.rb from environment-based to just 'pk_live_'\n2. Update auth.ts token validation regex to only accept pk_live_ (not pk_test_)\n3. Update all tests to use pk_live_ prefix\n4. Update auth.test.ts to use pk_live_ tokens","status":"closed","priority":1,"issue_type":"task","owner":"jspevack@gmail.com","created_at":"2026-01-25T13:09:11.105072-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T15:45:21.974413-07:00","closed_at":"2026-01-25T15:45:21.974413-07:00","close_reason":"Completed - simplified to pk_live_ only"}
{"id":"tts-zw5","title":"Honor return_to param for logged-in users in LoginsController","description":"logins_controller.rb:4 - When already logged-in user visits /login?return_to=/extension/connect, they get redirected to /episodes/new ignoring return_to.\n\nFix: Check return_to param and redirect there for logged-in users, especially for extension connect flow.\n\nAdd test for this scenario.","status":"closed","priority":2,"issue_type":"bug","owner":"jspevack@gmail.com","created_at":"2026-01-25T12:36:41.568624-07:00","created_by":"Jesse Spevack","updated_at":"2026-01-25T12:53:01.751033-07:00","closed_at":"2026-01-25T12:53:01.751033-07:00","close_reason":"Closed"}
